<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–Ω–µ–≤–Ω–∏–∫ –∑–¥–æ—Ä–æ–≤—å—è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script type="module" src="js/utils.js"></script>
    <script type="module" src="js/storage.js"></script>
    <script type="module" src="js/daily-tracker.js"></script>
    <script type="module" src="js/workout.js"></script>
    <script type="module" src="js/history.js"></script>
    <script type="module" src="js/analytics.js"></script>
    <script type="module" src="js/settings.js"></script>
    <script type="module" src="js/export.js"></script>
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/theme.js"></script>
    <script type="module" src="js/service-worker.js"></script>

    <!-- Favicon -->
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è favicon –¥–ª—è –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- –î–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">

    <!-- Apple Touch Icon (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã) -->
    <link rel="apple-touch-icon" href="icons/apple-icon-180x180.png">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Theme Color -->
    <meta name="theme-color" content="#4A90E2">
</head>
<body>
<div class="container">
    <header>
        <button id="theme-toggle" class="theme-toggle">
            <i class="fas fa-moon"></i>
        </button>
        <h1><i class="fas fa-heartbeat"></i> –î–Ω–µ–≤–Ω–∏–∫ –∑–¥–æ—Ä–æ–≤—å—è</h1>
        <div type="date" class="date-display" id="current-date"></div>
    </header>

    <div class="tabs">
        <button class="tab active" data-tab="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤–≤–æ–¥</button>
        <button class="tab" data-tab="workout">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
        <button class="tab" data-tab="history">–ò—Å—Ç–æ—Ä–∏—è</button>
        <button class="tab" data-tab="analytics">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
        <button class="tab" data-tab="settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≤–≤–æ–¥–∞ -->
    <div id="daily" class="tab-content active">
        <form id="daily-form">
            <div class="form-group time-input-container">
                <input type="date" id="entry-date" hidden>
            </div>

            <div class="form-grid">

                <div class="form-group">
                    <label for="pulse"><i class="fas fa-heart"></i> –ü—É–ª—å—Å (—É–¥/–º–∏–Ω):</label>
                    <input type="number" id="pulse" min="40" max="200">
                </div>

                <div class="form-group">
                    <label for="sleep"><i class="fas fa-bed"></i> –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞:</label>
                    <div class="time-input">
                        <input type="number" id="sleep-hours" placeholder="–ß" min="0" max="24" value="7">
                        <span>:</span>
                        <input type="number" id="sleep-minutes" placeholder="–ú" min="0" max="59" value="30">
                    </div>
                </div>

                <div class="form-group">
                    <label for="energy"><i class="fas fa-sun"></i> –£—Ç—Ä–µ–Ω–Ω—è—è —ç–Ω–µ—Ä–≥–∏—è:</label>
                    <div class="rating">
                        <input type="radio" id="energy-1" name="energy" value="1">
                        <label for="energy-1">1</label>
                        <input type="radio" id="energy-2" name="energy" value="2" checked>
                        <label for="energy-2">2</label>
                        <input type="radio" id="energy-3" name="energy" value="3">
                        <label for="energy-3">3</label>
                        <input type="radio" id="energy-4" name="energy" value="4">
                        <label for="energy-4">4</label>
                        <input type="radio" id="energy-5" name="energy" value="5">
                        <label for="energy-5">5</label>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label><i class="fas fa-weight-scale"></i> –í–∑–≤–µ—à–∏–≤–∞–Ω–∏—è:</label>
                    <div id="weighings-container"></div>
                    <button type="button" id="add-weight" class="btn-add">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ
                    </button>
                </div>

                <div class="form-group">
                    <label for="steps"><i class="fas fa-shoe-prints"></i> –®–∞–≥–∏:</label>
                    <input type="number" id="steps" min="0" max="50000">
                </div>

                <div class="form-group">
                    <label for="calories"><i class="fas fa-fire"></i> –ö–∞–ª–æ—Ä–∏–∏ (–∫–∫–∞–ª):</label>
                    <input type="number" id="calories" min="0" max="10000">
                </div>

                <div class="form-group">
                    <label for="alcohol"><i class="fas fa-wine-glass"></i> –ê–ª–∫–æ–≥–æ–ª—å:</label>
                    <select id="alcohol">
                        <option value="no">–ù–µ—Ç</option>
                        <option value="little">–ú–∞–ª–æ (1-2 –ø–æ—Ä—Ü–∏–∏)</option>
                        <option value="medium">–£–º–µ—Ä–µ–Ω–Ω–æ (3-4 –ø–æ—Ä—Ü–∏–∏)</option>
                        <option value="much">–ú–Ω–æ–≥–æ (5+ –ø–æ—Ä—Ü–∏–π)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="workout-data"><i class="fas fa-dumbbell"></i> –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:</label>
                    <select id="workout-data">
                        <option value="none">–ù–µ—Ç</option>
                        <option value="light">–õ–µ–≥–∫–∞—è</option>
                        <option value="medium">–°—Ä–µ–¥–Ω—è—è</option>
                        <option value="hard">–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∞—è</option>
                    </select>
                </div>

                <!-- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ RPE -->
                <div class="form-group" id="rpe-container" style="display: none;">
                    <label for="rpe"><i class="fas fa-chart-line"></i> –°–ª–æ–∂–Ω–æ—Å—Ç—å (RPE 1-10):</label>
                    <input type="number" id="rpe" min="1" max="10" placeholder="1-–ª–µ–≥–∫–∞—è, 10-–º–∞–∫—Å–∏–º—É–º">
                </div>

                <div class="form-group">
                    <label for="mood"><i class="fas fa-smile"></i> –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤–µ—á–µ—Ä–æ–º:</label>
                    <select id="mood">
                        <option value="excellent">–û—Ç–ª–∏—á–Ω–æ–µ üòÑ</option>
                        <option value="good">–•–æ—Ä–æ—à–µ–µ üôÇ</option>
                        <option value="normal">–ù–æ—Ä–º–∞–ª—å–Ω–æ–µ üòê</option>
                        <option value="bad">–ü–ª–æ—Ö–æ–µ üôÅ</option>
                        <option value="awful">–£–∂–∞—Å–Ω–æ–µ üòû</option>
                    </select>
                </div>

                <div class="form-group full-width">
                    <label for="notes"><i class="fas fa-edit"></i> –ó–∞–º–µ—Ç–∫–∏:</label>
                    <textarea id="notes" rows="3" placeholder="–û–ø–∏—à–∏—Ç–µ —Å–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ..."></textarea>
                </div>
            </div>

            <div class="form-buttons">
                <button type="submit" class="btn-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button type="button" class="btn-add" id="edit-entry-btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </form>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ -->
    <div id="workout" class="tab-content">
        <form id="workout-form">
            <input type="hidden" id="exercise-id">

            <div class="form-group">
                <label for="exercise-name"><i class="fas fa-dumbbell"></i> –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:</label>
                <input type="text" id="exercise-name" list="exercise-list" placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ">
                <datalist id="exercise-list"></datalist>
            </div>

            <div class="form-group">
                <label for="workout-rpe"><i class="fas fa-chart-line"></i> –°–ª–æ–∂–Ω–æ—Å—Ç—å (RPE 1-10):</label>
                <input type="number" id="workout-rpe" min="1" max="10" placeholder="1-–ª–µ–≥–∫–∞—è, 10-–º–∞–∫—Å–∏–º—É–º">
            </div>

            <div class="form-group">
                <label><i class="fas fa-list-ol"></i> –ü–æ–¥—Ö–æ–¥—ã:</label>
                <table id="sets-table">
                    <thead>
                    <tr>
                        <th>–í–µ—Å (–∫–≥)</th>
                        <th>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody id="sets-body">
                    <tr>
                        <td><input type="number" class="set-weight" step="0.1" min="0"></td>
                        <td><input type="number" class="set-reps" min="1"></td>
                        <td><button type="button" class="btn-remove-set"><i class="fas fa-times"></i></button></td>
                    </tr>
                    </tbody>
                </table>
                <button type="button" id="add-set" class="btn-add">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥
                </button>
            </div>

            <div class="form-buttons">
                <button type="submit" class="btn-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
                <button type="button" class="btn-add" id="edit-workout-btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>

            <div id="saved-exercises">
                <h3>–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
                <div id="exercises-list"></div>
            </div>
        </form>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞" -->
    <div class="tab-content" id="analytics">
        <h2>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
        <div class="chart-container">
            <canvas id="weight-chart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="sleep-chart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="energy-chart"></canvas>
        </div>
        <div class="chart-container">
            <h3>–ü—Ä–æ–≥—Ä–µ—Å—Å –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è—Ö (1–ü–ú)</h3>
            <div class="exercise-controls">
                <select id="exercise-filter" class="form-control">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>
                    <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </select>
            </div>
            <canvas id="exercise-chart"></canvas>
        </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ "–ò—Å—Ç–æ—Ä–∏—è" -->
    <div id="history" class="tab-content">
        <h2>üóÑÔ∏è –ò—Å—Ç–æ—Ä–∏—è</h2>
        <div class="history-controls">
            <select id="history-date">
                <option value="all">–í—Å–µ –¥–∞—Ç—ã</option>
                <option value="week">–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è</option>
            </select>
        </div>
        <div id="history-list"></div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" -->
    <div class="tab-content" id="settings">
        <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <form id="settings-form">
            <div class="form-group">
                <label>–í–∫–ª—é—á–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:</label>
                <input type="checkbox" id="reminder-toggle">
            </div>
            <div class="form-group">
                <label>–í—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:</label>
                <input type="time" id="reminder-time">
            </div>
            <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </form>
    </div>
</div>

<script type="module" src="js/main.js"></script>
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('SW registered:', reg))
                .catch(err => console.error('SW registration failed:', err));
        });
    }

    window.addEventListener('beforeinstallprompt', e => {
        e.preventDefault();
        const installBtn = document.createElement('button');
        installBtn.textContent = '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ';
        installBtn.className = 'install-button';
        installBtn.onclick = () => {
            e.prompt();
            installBtn.remove();
        };
        document.body.appendChild(installBtn);
    });
</script>
</body>
</html>
